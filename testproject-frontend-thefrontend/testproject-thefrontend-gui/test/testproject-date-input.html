<!--
  This file will NOT be overwritten by Barrakuda.
  This file was automatically generated by Barrakuda.
-->
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>date-input tests</title>

    <script src="../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
    <script src="../bower_components/web-component-tester/browser.js"></script>

    <!-- Import the element to test -->
    <link rel="import" href="../src/common-libs/testproject-date-input.html">

    <!-- Import common lib -->
    <link rel="import" href="../src/common-libs/common-utils.html">
  </head>
  <body>
    <test-fixture id="DateInputInThePast">
      <template>
            <testproject-date-input
                class="testproject-keeper-birthday-field"
                id="keeper-birthday"
                name="birthday"
                auto-validate="true"
                validation-type="inThePast"
            >
        </testproject-date-input>
      </template>
    </test-fixture>
    <test-fixture id="DateInputInTheFuture">
        <template>
              <testproject-date-input
                  class="testproject-keeper-birthday-field"
                  id="keeper-birthday"
                  name="birthday"
                  auto-validate="true"
                  validation-type="inTheFuture"
              >
          </testproject-date-input>
        </template>
    </test-fixture>
    <test-fixture id="DateInputNoValidation">
        <template>
              <testproject-date-input
                  class="testproject-keeper-birthday-field"
                  id="keeper-birthday"
                  name="birthday"
                  auto-validate="true"
              >
          </testproject-date-input>
        </template>
    </test-fixture>

    <script>
      suite('testproject-date-input validation tests', function() {
        var testprojectDateInputPast, dateInputFuture, dateInputNone;

        setup(function() {
          dateInputPast = fixture('DateInputInThePast');
          dateInputFuture = fixture('DateInputInTheFuture');
          dateInputNone = fixture('DateInputNoValidation');
        });

        test('inThePast - a value in the future should be invalid', function(done) {
          // set a value in the future
          dateInputPast.value = '2099-12-12';
          
          flush(function() {
            var paperInput = findPaperInput(dateInputPast);
            var vaadinDatePicker = findVaadinDatePicker(dateInputPast);
            if (paperInput != null) {
              assert.isFalse(paperInput.validate());
            } else if (vaadinDatePicker != null) {
              assert.isFalse(vaadinDatePicker.validate());
            } else {
              failNoInputFound();
            }
            done();
          });
        });

        test('inThePast - a value in the past should be valid', function(done) {
          // set a value in the future
          dateInputPast.value = '1999-12-12';
          
          flush(function() {
            var paperInput = findPaperInput(dateInputPast);
            var vaadinDatePicker = findVaadinDatePicker(dateInputPast);
            if (paperInput != null) {
              assert.isTrue(paperInput.validate());
            } else if (vaadinDatePicker != null) {
              assert.isTrue(vaadinDatePicker.validate());
            } else {
              failNoInputFound();
            }
            done();
          });
        });

        test('inTheFuture - a value in the past should be invalid', function(done) {
          // set a value in the future
          dateInputFuture.value = '2000-12-12';
          
          flush(function() {
            var paperInput = findPaperInput(dateInputFuture);
            var vaadinDatePicker = findVaadinDatePicker(dateInputFuture);
            if (paperInput != null) {
              assert.isFalse(paperInput.validate());
            } else if (vaadinDatePicker != null) {
              assert.isFalse(vaadinDatePicker.validate());
            } else {
              failNoInputFound();
            }
            done();
          });
        });

        test('inTheFuture - a value in the future should be valid', function(done) {
          // set a value in the future
          dateInputFuture.value = '2099-12-12';
          
          flush(function() {
            var paperInput = findPaperInput(dateInputFuture);
            var vaadinDatePicker = findVaadinDatePicker(dateInputFuture);
            if (paperInput != null) {
              assert.isTrue(paperInput.validate());
            } else if (vaadinDatePicker != null) {
              assert.isTrue(vaadinDatePicker.validate());
            } else {
              failNoInputFound();
            }
            done();
          });
        });

        test('none - future date value should be valid', function(done) {
          // set a value in the future
          dateInputNone.value = '2099-12-12';
          
          flush(function() {
            var paperInput = findPaperInput(dateInputNone);
            var vaadinDatePicker = findVaadinDatePicker(dateInputNone);
            if (paperInput != null) {
              assert.isTrue(paperInput.validate());
            } else if (vaadinDatePicker != null) {
              assert.isTrue(vaadinDatePicker.validate());
            } else {
              failNoInputFound();
            }
            done();        
          });
        });
        
        test('none - past date value should be valid', function(done) {
          // set a value in the past
          dateInputNone.value = '1999-12-12';
          flush(function () {
            var paperInput = findPaperInput(dateInputNone);
            var vaadinDatePicker = findVaadinDatePicker(dateInputNone);
            if (paperInput != null) {
              assert.isTrue(paperInput.validate());
            } else if (vaadinDatePicker != null) {
              assert.isTrue(vaadinDatePicker.validate());
            }
            done();
          });
        });

        findPaperInput = function (fixture) {
          return fixture.shadowRoot.querySelector('paper-input');
        }
        findVaadinDatePicker = function(fixture) {
          return fixture.shadowRoot.querySelector('vaadin-date-picker');
        }
        failNoInputFound = function() {
          assert.fail("paper-input or vaadin-date-picker present", "paper-input or vaadin-date-picker not present", "No paper-input or vaadin-date-picker present!");
        }
      });
    </script>
  </body>
</html>
<!doctype html>
